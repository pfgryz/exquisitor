\cleardoublepage
\section{Wstęp teoretyczny}

    % ===== ===== ===== =====
    % KLUCZOWE POJĘCIA I DEFINICJE
    % ===== ===== ===== =====
    \subsection{Kluczowe pojęcia i definicje}

        \subsubsection{Sekwencja DNA}

        Sekwencja DNA to sekwencja genetyczna stanowiąca zapis informacji genetycznej, który w sposób symboliczny odwzorowuje strukturę cząstki DNA, stosując alfabet złożony z czterech symboli: \texttt{A, T, C, G}. Każdy z symboli odnosi się do jednej z zasad azotowych zawartych w nukleotydach tworzących cząsteczkę DNA, odpowiednio: adeniny, tyminy, cytozyny oraz guaniny.
        Taki opis jest nazywany strukturą pierwszorzędową.

        \subsubsection{$k$-mer}

            $k$-mer to podsłowo sekwencji genetycznej o długości $k$. Dla danego alfabetu $G$ składające się z $n$ symboli istnieje dokładnie $n^k$ różnych $k$-merów o długości $k$. Sekwencja genetyczna o długości $m$ zawiera dokładnie $m - k + 1$ $k$-merów o długości $k$.


        \subsubsection{Dopasowanie sekwencji}

            Proces dopasowania sekwencji polega na wyrównaniu ich symboli w celu maksymalizacji ich wzajemnego podobieństwa, co realizowane może być poprzez wstawianie przerw (ang. \textit{gaps}) między symbolami sekwencji wejściowych. Dopasowanie sekwencji może być realizowane na dwa sposoby: lokalnie, gdzie maksymalizowane jest podobieństwo fragmentów sekwencji niezależnie od ich położenia oraz globalnie, gdzie maksymalizowane jest podobieństwo całych sekwencji. Wynikiem dopasowania są sekwencje z opcjonalnie wstawionymi przerwami oraz miara jakości dopasowania lub miara podobieństwa między sekwencjami.

        \subsubsection{Uczenie kontrastowe}

            Uczenie kontrastowe (ang. \textit{contrastive learning}) \cite{Bromley:1993} jest metodą uczenia maszynowego polegającą na maksymalizacji podobieństwa między podobnymi próbkami oraz minimalizacji podobieństwa między niepodobnymi próbkami. Wykorzystuje ona miary niepodobieństwa między reprezentacjami do nauki odróżniania kluczowych cech próbek. Zastosowanie tej metody pozwala na redukcję wymiarowości danych przy jednoczesnym zachowaniu właściwości podobieństwa i niepodobieństwa między danymi wejściowymi.

        \subsubsection{Podobieństwo kosinusowe}

            Podobieństwo kosinusowe to miara, która określa jak bardzo zbliżone, są wektory pod względem kierunku w przestrzeni wielowymiarowej. Miara wyrażona jest za pomocą kosinusa kąta między wektorami i przyjmuje wartości z zakresu $[-1; 1]$, gdzie $1$ określa pełne podobieństwo, a $-1$ całkowity brak podobieństwa. Podobieństwo kosinusowe wyrażone jest wzorem:

            \begin{equation}
                similarity_{cosine}(A, B) = \cos{\theta} = \frac{A \cdot B}{\|A\| \|B\|} = \frac{
                    \sum^{n}_{i = 1}A_i B_i
                }{
                    \sqrt{
                        \sum^{n}_{i = 1}A_i^2
                    }
                    \cdot
                    \sqrt{
                        \sum^{n}_{i = 1}B_i^2
                    }
                }
            \end{equation}

            gdzie:
            \begin{align*}
                A, B -& \text{porównywane wektory,} \\
                \theta -& \text{kąt między wektorami $A$ i $B$,} \\
                A_j, B_j -& \text{$j$-ty element wektora odpowiednio $A$ oraz $B$.}
            \end{align*}

        \subsubsection{Niepodobieństwo kosinusowe}

            Niepodobieństwo kosinusowe to miara, która określa, jak bardzo wektory różnią się pod względem kierunku. Wyrażone jest wzorem:

            \begin{equation}
                dissimilarity_{cosine}(A, B) = 1 - similarity_{cosine}(A, B)
                \label{Equation:CosineDissimilarity}
            \end{equation}

            gdzie:
            \begin{align*}
                A, B &- \text{porównywane wektory.} \\
            \end{align*}

        \subsubsection{Format FASTA}

            Format FASTA jest to tekstowy format zapisu sekwencji nukleotydów. Nukleotydy reprezentowane są przez znaki \texttt{A, C, T, G}. Format składa się z jednej linii rozpoczynającej się znakiem \texttt{>} zawierającej identyfikator i opcjonalny opis oraz kolejnych linii zawierających sekwencję nukleotydów. Możliwy jest zapis wielu sekwencji w formacie FASTA w jednym pliku poprzez połączenie wielu sekwencji zapisanych w tym formacie.

        \subsubsection{Format FASTQ}

            Format FASTQ jest to tekstowy format zapisu sekwencji nukleotydów, który zawiera dodatkowo informację o jakości sekwencjonowania. Format umożliwia zapis wielu sekwencji w jednym pliku. Zapis każdej sekwencji składa się z czterech części.
            \begin{enumerate}
                \item {
                    Pierwsza część to linia rozpoczynająca się od znaku \texttt{@} i zawierająca identyfikator oraz opcjonalny opis sekwencji.
                }
                \item {
                    Druga część to linie zawierające sekwencję nukleotydów, reprezentowanych przez znaki \texttt{A, C, T, G}.
                }
                \item {
                    Trzecia część to znak \texttt{+}, który oddziela sekwencję od informacji o jakości.
                }
                \item {
                    Czwarta część to linie zawierające zapis informacji o jakości sekwencjonowania. Informacja ta jest zakodowana za pomocą pojedynczych znaków ASCII, które odpowiadają jakości poszczególnych nukleotydów w sekwencji.
                }
            \end{enumerate}

            \subsubsection{BLASTn}
            \todo{zmieniłem czcionkę, texttt nie występuje w nazwach formatów i algorytmów}

            BLASTn (ang. \textit{Basic Local Alignment Search Tool for Nucleotides}) to wariant narzędzia bioinformatycznego BLAST, zaprojektowany do porównywania sekwencji nukleotydów. Umożliwia wyszukiwanie podobieństw między analizowanymi sekwencjami nukleotydów a sekwencjami znajdującymi się w wybranej bazie sekwencji nukleotydów. Może być wykorzystywany do przeprowadzania klasyfikacji taksonomicznej.

        \subsubsection{Klasyfikacja taksonomiczna}

            Klasyfikacja taksonomiczna sekwencji DNA to proces przypisywania sekwencji DNA do określonych grup taksonomicznych takich jak gatunki czy rodzaje, na podstawie ich podobieństwa do znanych sekwencji w bazach sekwencji genetycznych.

        \subsubsection{Algorytm $k$-medoidów}

            Algorytm $k$-medoidów to metoda grupowania danych, w której dane podzielone są na $k$ grup, a reprezentantem każdej grupy jest rzeczywisty punkt danych, zwany medoidem. Algorytm znajduje zastosowanie w problemach, w których nie można wyznaczyć średniej lub centroidu np. w przypadku danych kategorycznych.

    % ===== ===== ===== =====
    % PRZEGLĄD LITERATURY
    % ===== ===== ===== =====
    \subsection{Przegląd literatury}

        Badania nad klasyfikacją taksonomiczną sekwencji DNA cechują się dynamicznym rozwojem w ciągu ostatnich 25 lat. Wprowadzenie metod sekwencjonowania nowej generacji pozwoliło na analizę dużych ilości materiału genetycznego pochodzącego z różnych środowisk. Optymalizacja procesu klasyfikacji taksonomicznej stała się głównym kierunkiem rozwoju narzędzi do klasyfikacji, szczególnie w przypadku narzędzi opartych na bazach danych sekwencji genetycznych, ponieważ liczba sekwencji w tych bazach podwaja się średnio co 30 miesięcy~\cite{Benson:2008}.

        Historycznie jednym z pierwszych algorytmów, który umożliwił klasyfikację taksonomiczną był algorytm Needlemana-Wunscha\cite{Needleman:1970} opracowany w 1970 roku, który pozwalał na porównywanie sekwencji genetycznych. Jednak pierwszym rozwiązaniem, które pozwalało na klasyfikację taksonomiczną w rozsądnym czasie, było narzędzie stworzone w 1983 roku przez D. Lipmana i W. Wilbura\cite{Wilbur:1983}. Bazowało ono na podziale sekwencji na $k$-krotki, które są uogólnieniem $k$-merów i ich porównywaniu. Rozwinięciem tego rozwiązania był algorytm ,,BLAST'' przedstawiony w 1990 roku\cite{Altschul:1990} bazujący na $k$-merach oraz umożliwiający wyszukiwanie sekwencji podobnych w bazach NCBI. Innym podejściem powstałym w podobnym okresie było narzędzie ,,Clustal''\cite{Higgins:1988} stworzone w 1988 roku, które pozwalało na wyrównywanie wielu sekwencji genetycznych.

        Największy postęp w badaniach nastąpił jednak w ciągu ostatnich 15 lat, czego przykładem jest utworzenie w 2012 roku narzędzia ,,MetaPhlAn''\cite{Segata:2012}, które wykorzystuje geny wskaźnikowe do porównywania składu gatunkowego próbek metagenomicznych. Kolejnym podejściem opartym na genach wskaźnikowych jest narzędzie ,,mOTUs2''\cite{Milanese:2019}, które bazuje na identyfikacji i analizie markerów unikalnych dla specyficznych szczepów mikroorganizmów. Inne podejście zostało zastosowane w narzędziu ,,Centrifuge''\cite{Kim:2016} opracowanym w 2016 roku, które wykorzystuje indeksowanie sekwencji za pomocą transformacji Burrowsa-Wheelera\cite{Burrows:1994} oraz indeksu Ferraginy-Manziniego\cite{Ferragina:2000} w celu efektywne wyszukiwania sekwencji podobnych. Bardziej klasyczne podejście zostało zastosowane w narzędziu ,,Kraken''\cite{Wood:2014} przedstawionym w 2014 roku, które wykorzystuje $k$-mery wraz z indeksowaną bazą sekwencji.

        Inną metodę optymalizacji procesu klasyfikacji taksonomicznej przedstawili Gautier i Lund w 2013 roku\cite{Gautier:2013}. Ich metoda opierała się na rozproszonej architekturze, w której serwer zwracał wskazówki dotyczące możliwych sekwencji do analizy na podstawie losowo wybranych sekwencji wejściowych, co pozwoliło na redukcję przesyłanych danych przez sieć. Nietypowe podejście do zadania klasyfikacji taksonomicznej przedstawiono w 2022 roku w narzędziu ,,BERTax''\cite{Mock:2022}. Narzędzie to wykorzystuje model typu transformer\cite{Transformers} do analizy sekwencji DNA, traktując je jako specyficzny język, na podstawie którego można dokonać przypisania bez potrzeby korzystania z baz referencyjnych. Kolejnym rozwiązaniem wykorzystującym modele uczenia maszynowego jest narzędzie ,,CGRclust''\cite{Alipour:2024}, które grupuje sekwencje DNA za pomocą dwuwymiarowej reprezentacji gier chaosu, łącząc nienadzorowane uczenie kontrastowe ze splotowymi sieciami neuronowymi.

        Choć w ostatnich latach pojawiły się badania dotyczące klasyfikacji taksonomicznej z wykorzystaniem metod uczenia maszynowego, to wciąż brakuje prac skupiających się na zastosowaniu sztucznych sieci neuronowych z uczeniem kontrastowym do efektywnego grupowania sekwencji, co mogłoby znacząco przyspieszyć proces klasyfikacji przy użyciu dostępnych narzędzi.

    % ===== ===== ===== =====
    % METODY I PODEJŚCIA
    % ===== ===== ===== =====
    \subsection{Metody i podejścia}

        W pracy zostaną wykorzystane dwa klasyczne podejścia do klasyfikacji taksonomicznej sekwencji genetycznych. Pierwsze z nich opiera się na wyrównaniu sekwencji, przy czym zostanie wykorzystany zmodyfikowany algorytm Needlemana-Wunscha. Drugie podejście wykorzystuje $k$-mery, w którym do obliczeń zostana zastosowane proste zanurzenia oraz odległość euklidesowa.

        \subsubsection{Algorytm Needlemana-Wunscha}

            Algorytm Needlemana-Wunscha jest klasycznym algorytmem do wyrównywania globalnego sekwencji genetycznych. Metoda ta polega na zbudowaniu macierzy podobieństwa między sekwencjami zgodnie z ustalonymi regułami, które zostały przedstawione w równaniu~\eqref{Equation:NeedlemanWunsch}. W przypadku klasyfikacji taksonomicznej do dalszych obliczeń wystarczy wartość jakości dopasowania zawarta w $D_{n + 1, m + 1}$.

            \begin{equation}
                \begin{aligned}
                    D_{i,0} &= i \cdot g, & \text{dla } & i \in [1, n + 1] \\
                    D_{0,j} &= j \cdot g, & \text{dla } & j \in [2, m + 1] \\
                    D_{i,j} &= \max
                    \begin{cases}
                        D_{i - 1, j} + g \\
                        D_{i, j - 1} + g \\
                        D_{i - 1, j - 1} + s(A_i, B_j)
                    \end{cases}, & \text{dla } & i \in (1, n + 1] \text{ oraz } j \in (1, m + 1]
                \end{aligned}
                \label{Equation:NeedlemanWunsch}
            \end{equation}

            gdzie:
            \begin{align*}
                A, B -& \text{porównywane sekwencje}, \\
                n, m -& \text{długości sekwencji } A \text{ oraz } B, \\
                D -& \text{macierz podobieństwa o rozmiarach } n + 1 \text{ x } m + 1, \\
                g \in \mathbb{R} -& \text{kara za przerwę}, \\
                s(A_i, B_j) \in \mathbb{R} -& \text{podobieństwo między } i \text{-tym elementem w sekwencji A,} \\
                & \text{a } j \text{-tym elementem w sekwencji B}. \\
            \end{align*}

        \subsubsection{Zanurzenia $k$-merów}

            Wykorzystanie $k$-merów w roli zanurzeń pozwala na reprezentację sekwencji DNA w postaci wektorów liczbowych, które można porównywać za pomocą różnych miar, takich jak na przykład odległość euklidesowa. Wektory liczbowe pozwalają na kompaktową reprezentację długich sekwencji, co znacznie przyśpiesza procesy grupowania sekwencji oraz klasyfikacji taksonomicznej. Metoda ta jest obecnie jedną z najpopularniejszych metod stosowanych do klasyfikacji taksonomicznej z wykorzystaniem baz danych, ponieważ cechuje się wysoką prędkością działania oraz pozwala uzyskać dobre wyniki. Obecne narzędzia wykorzystują różne miary, parametry $k$ oraz dodatkowe mechanizmy do dalszej optymalizacji tej metody.

    % ===== ===== ===== =====
    % TEORETYCZNE PODSTAWY PROBLEMU
    % ===== ===== ===== =====
    \subsection{Sztuczne sieci neuronowe}

        Sztuczna sieć neuronowa to model matematyczny inspirowany strukturą i działaniem systemu nerwowego organizmów biologicznych, który jest stosowany do rozwiązywania problemów bez uprzedniej definicji matematycznej danego zagadnienia\cite{Leksykon}. Sieć neuronowa składa się z neuronów, czyli podstawowych jednostek przetwarzających informacje, które są wzorowane na funkcjonowaniu biologicznych komórek nerwowych, choć w znacznie uproszczonej formie\cite{Leksykon}. Sieć jest logicznie zorganizowana w warstwy, czyli grupy neuronów pełniące określone funkcje\cite{Leksykon}.

        Jednym z podstawowych typów warstw są warstwy w pełni połączone (ang. \textit{Fully Connected Layers, FCN}), które składają się z neuronów połączonych ze wszystkimi neuronami poprzedniej warstwy. \cite{Leksykon}. Kolejnym typem warstw w sieciach neuronowych są warstwy splotowe, które wykorzystywane są głównie w przypadku danych o strukturze wielowymiarowej. Warstwa splotowa stosuje operację splotu, przetwarzając dane wejściowe i identyfikując istotne cechy strukturalne tych danych\cite{LeCun:2015}. Specyficznym typem warstw są warstwy spłaszczające, które przekształcają dane wielowymiarowe w wektor jednowymiarowy, umożliwiają one łączenie warstw splotowych z warstwami w pełni połączonymi.

        Normalizacja wsadowa (ang. \textit{batch normalization}) jest metodą, która pozwala na przyspieszenie procesu uczenia oraz zwiększa stabilność sztucznych sieci neuronowych\cite{Ioffe:2015}. Wygaszanie (ang. dropout)\cite{Wan:2013} jest techniką regularyzacji, która pomaga w redukcji przeuczenia\cite{Leksykon}.

        Wyjściem ostatniej warstwy modelu sztucznej sieci neuronowej może być wektor zanurzeń, czyli reprezentacja danych w przestrzeni o zredukowanej liczbie wymiarów w przypadku zadań, które wymagają redukcji wymiarowości danych wejściowych.
